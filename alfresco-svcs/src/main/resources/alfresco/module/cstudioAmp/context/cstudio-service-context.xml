<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <!-- Properties -->
    <bean id="cstudio-alfresco-services-properties" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="ignoreUnresolvablePlaceholders">
            <value>true</value>
        </property>
        <property name="locations">
            <list>
                <value>classpath:alfresco/module/cstudioAmp/cstudio-services-cfg.properties</value>
                <value>classpath*:crafter/cstudio/extension/custom-cstudio-services-cfg.properties</value>
            </list>
        </property>
        <property name="systemPropertiesModeName">
            <value>SYSTEM_PROPERTIES_MODE_OVERRIDE</value>
        </property>
    </bean>

    <bean id="cstudioActionMessages" parent="actionResourceBundles">
        <property name="resourceBundles">
            <list>
                <value>alfresco.module.cstudioAmp.messages.action-messages</value>
            </list>
        </property>
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--         logging                        -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioLogProvider" class="org.craftercms.cstudio.impl.log.l4j.L4jLogProvider"
          init-method="init">
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--         services                       -->
    <!-- ////////////////////////////////////// -->


    <bean id="cstudioRegistrableService" class="org.craftercms.cstudio.alfresco.service.AbstractRegistrableService"
          abstract="true" init-method="register">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioDmTransactionService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmTransactionServiceImpl"
        parent="cstudioRegistrableService">
        <property name="transactionManager" ref="transactionManager" />
    </bean>

    <bean id="cstudioNamespaceService" class="org.craftercms.cstudio.alfresco.service.impl.NamespaceServiceImpl"
            parent="cstudioRegistrableService"/>

    <bean id="cstudioModelService" class="org.craftercms.cstudio.alfresco.service.impl.ModelServiceImpl"
            parent="cstudioRegistrableService">
        <property name="siteDataPath"><value>${modelService.siteDataPath}</value></property>
    </bean>


    <bean id="cstudioDmContentService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmContentServiceImpl"
            parent="cstudioRegistrableService">
        <property name="contentProcessor" ref="cstudioProcessContentExecutor"/>
        <property name="cache" ref="cstudioCacheManager" />
        <property name="propertyLoaders" ref="cstudioPropertyLoaders"/>
    </bean>

    <bean id="cstudioFileLockService" class="org.craftercms.cstudio.alfresco.dm.util.impl.lock.FileLockServiceImpl"
            parent="cstudioRegistrableService"/>

    <bean id="cstudioPageNavOrderService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmPageNavigationOrderServiceImpl"
            parent="cstudioRegistrableService">
        <property name="pageNavigationOrderSequenceDaoService" ref="cstudioPageNavogationOrderSequenceDaoService" />
    </bean>
    
    <bean id="cstudioDmRenameService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmRenameServiceImpl"
            parent="cstudioRegistrableService">
        <property name="cacheManager" ref="cstudioCacheManager" />
        <property name="listener" ref="cstudioWorkflowListener" />
        <property name="submitDirectWorkflowName"><value>${cstudioDmWorkflowService.submitDirectWorkflowName}</value></property>
        <property name="workflowProcessor" ref="cstudioWorkflowProcessor" />
    </bean>


    <bean id="cstudioDmPreviewService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmPreviewServiceImpl"
            parent="cstudioRegistrableService">
        <property name="contentProcessor" ref="cstudioPreviewProcessContentExecutor"/>
    </bean>
    <bean id="cstudioActivityService" class="org.craftercms.cstudio.alfresco.service.impl.ActivityServiceImpl"
            parent="cstudioRegistrableService">
        <property name="feedGenerator" ref="cstudioFeedGenerator" />
        <!--<property name="postLookup" ref="postLookup" />-->
    </bean>
    
    <bean id="cstudioSequenceService" class="org.craftercms.cstudio.alfresco.service.impl.SequenceServiceImpl"
            parent="cstudioRegistrableService">
        <property name="sequenceDaoService" ref="cstudioSequenceDaoService" />
    </bean>
    
    <bean id="cstudioContentLifeCycleService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmContentLifeCycleServiceImpl"
            parent="cstudioRegistrableService">
        <property name="scriptLocation"><value>${ContentLifeCycleProcessor.scriptLocation}</value></property>
        <property name="scriptObjects">
            <map>
            </map>
        </property>
    </bean>

    <bean id="cstudioDmWorkflowService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmSimpleWorkflowServiceImpl"
            parent="cstudioRegistrableService">
        <property name="listener" ref="cstudioWorkflowListener" />
        <property name="cacheManager" ref="cstudioCacheManager" />
        <property name="submitDirectWorkflowName"><value>${cstudioDmWorkflowService.submitDirectWorkflowName}</value></property>
        <property name="reviewWorkflowName"><value>${cstudioDmWorkflowService.reviewWorkflowName}</value></property>
        <property name="dmFilterWrapper" ref="cstudioDmFilterWrapper"/>
        <property name="workflowProcessor" ref="cstudioWorkflowProcessor" />
        <property name="scheduleDeleteHandler" ref="cstudioScheduleDeleteHandler"/>
        <property name="customContentTypeNotification" value="${notificationService.customContentPathNotification}" />
        <property name="customContentTypeNotificationPattern" value="${notificationService.customContentPathNotificationPattern}" />
        <property name="deploymentService" ref="cstudioDeploymentServiceSimple" />
    </bean>

    <bean id="cstudioSearchService" class="org.craftercms.cstudio.alfresco.service.impl.SearchServiceImpl"
            parent="cstudioRegistrableService">
        <property name="searchResultExtractor" ref="cstudioDmSearchResultExtractor" />
        <property name="queryBuilders">
            <map>
                <entry key="lucene"><ref bean="cstudioLuceneSearchQueryBuilder"></ref></entry>
                <entry key="xpath"><ref bean="cstudioXPathSearchQueryBuilder"></ref></entry>
            </map>
        </property>
    </bean>

    <bean id="cstudioDmSearchService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmSearchServiceImpl"
            parent="cstudioRegistrableService">
        <property name="searchResultExtractor" ref="cstudioDmContentSearchResultExtractor" />
        <property name="queryBuilders">
            <map>
                <entry key="lucene"><ref bean="cstudioDmLuceneSearchQueryBuilder"></ref></entry>
                <entry key="solr-fts-alfresco"><ref bean="cstudioDmSolrSearchQueryBuilder"></ref></entry>
                <entry key="xpath"><ref bean="cstudioXPathSearchQueryBuilder"></ref></entry>
            </map>
        </property>
    </bean>

    <bean id="cstudioSynchronizationService" class="org.craftercms.cstudio.alfresco.service.impl.SynchronizationServiceImpl"
            parent="cstudioRegistrableService">
        <property name="deployer" ref="previewDeployer" />
    </bean>

    <bean id="cstudioDmVersionService" class="org.craftercms.cstudio.alfresco.service.impl.DmVersionServiceImpl"
            parent="cstudioRegistrableService" >
        <property name="policyBehaviourFilter" ref="policyBehaviourFilter" />
    </bean>
    
    <bean id="cstudioProfileService" class="org.craftercms.cstudio.alfresco.service.impl.ProfileServiceImpl"
            parent="cstudioRegistrableService">
        <property name="configPath"><value>${profileService.configPath}</value></property>
        <property name="configFileName"><value>${profileService.configFileName}</value></property>
    </bean>

    <bean id="cstudioSiteService" class="org.craftercms.cstudio.alfresco.service.impl.SiteServiceImpl"
            parent="cstudioRegistrableService">
        <property name="environmentConfig" ref="cstudioEnvironmentConfig"/>
        <property name="environmentConfigPath"><value>${environmentConfig.configPath}</value></property>
        <property name="configRoot"><value>${siteService.configPath}</value></property>
        <property name="sitesConfigPath"><value>${siteService.sitesConfigPath}</value></property>
        <property name="configFileName"><value>${environmentConfig.configFileName}</value></property>
        <property name="environment"><value>${environmentConfig.environment}</value></property>
        <property name="deploymentConfigPath"><value>${deploymentConfig.configPath}</value></property>
        <property name="deploymentEndpointConfig" ref="cstudioDeploymentConfig" />
        <property name="deploymentService" ref="cstudioDeploymentServiceSimple" />
    </bean>

    <bean id="cstudioDmContentTypeService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmContentTypeServiceImpl"
            parent="cstudioRegistrableService">
        <property name="configPath"><value>${dmContentTypeService.configPath}</value></property>
        <property name="configFileName"><value>${dmContentTypeService.configFileName}</value></property>
    </bean>

    <bean id="cstudioPermissionService" class="org.craftercms.cstudio.alfresco.service.impl.PermissionServiceImpl"
            parent="cstudioRegistrableService">
        <property name="configPath"><value>${permissionService.configPath}</value></property>
        <property name="roleMappingsFileName"><value>${permissionService.roleMappingFileName}</value></property>
        <property name="permissionsFileName"><value>${permissionService.permissionMappingFileName}</value></property>
    </bean>

    <bean id="cstudioDmDependencyService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmDependencyServiceImpl"
            parent="cstudioRegistrableService">
        <property name="dependencyDaoService" ref="cstudioDependencyDaoService" />
        <property name="cacheManager" ref="cstudioCacheManager" />
    </bean>

       <bean id="cstudioDmDependencyDiffService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmDependencyDiffService"
               parent="cstudioRegistrableService" />

    <bean id="cstudioNotificationService" class="org.craftercms.cstudio.alfresco.service.impl.NotificationServiceImpl"
            parent="cstudioRegistrableService">
        <property name="emailMessages" ref="cstudioEmailMessageQueue" />
        <property name="configPath"><value>${notificationService.configPath}</value></property>
        <property name="configFileName"><value>${notificationService.configFileName}</value></property>
    </bean>

    <bean id="cstudioDmPublishService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmPublishServiceImpl"
            parent="cstudioRegistrableService">
        <property name="dmFilterWrapper" ref="cstudioDmFilterWrapper"/>
        <property name="deploymentService" ref="cstudioDeploymentServiceSimple" />
    </bean>

    <bean id="cstudioDmMetadataService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmMetadataServiceImpl"
            parent="cstudioRegistrableService">
        <property name="scriptLocation"><value>${ExtractMetadataProcessor.scriptLocation}</value></property>
        <property name="scriptObjects"> <!-- this is not right -->
            <map>
                <entry key="dmDependencyService"><ref bean="cstudioDmDependencyServiceScript"></ref></entry>
            </map>
        </property>
    </bean>
    
    <bean id="cstudioDmActivityService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmActivityServiceImpl"
            parent="cstudioRegistrableService">
        <property name="contentItemExtractor" ref="cstudioDmContentItemExtractor"/>
        <!--<property name="feedGenerator" ref="feedGenerator" />-->
        <!--<property name="postLookup" ref="postLookup" />-->
        <property name="dmFilterWrapper" ref="cstudioDmFilterWrapper"/>
    </bean>

    <!--import resource="classpath:crafter/core/cache-context.xml"/ -->
    <import resource="classpath:alfresco/module/cstudioAmp/context/cstudio-crafter-cache-context.xml" />
    
        <bean id="cstudioPersistenceManagerService" class="org.craftercms.cstudio.alfresco.service.impl.PersistenceManagerServiceImpl"
            parent="cstudioRegistrableService">
            <property name="cache" ref="crafter.cache" />
            <property name="companyHomeNodeLocator" ref="companyHomeNodeLocator" />
            <property name="propertyLoaders" ref="cstudioPropertyLoaders"/>
            <property name="cStudioActivityFeedDaoService" ref="cstudioCustomFeedDaoService" />
            <property name="dependencyDaoService" ref="cstudioDependencyDaoService" />
            <property name="objectStateDAOService" ref="cstudioObjectStateDaoService" />
            <property name="pageNavigationOrderSequenceDaoService" ref="cstudioPageNavogationOrderSequenceDaoService" />
            <property name="companyHomeStore"><value>${spaces.store}</value></property>
            <property name="companyHomePath"><value>/${spaces.company_home.childname}</value></property>
            <property name="policyBehaviourFilter" ref="policyBehaviourFilter" />
        </bean>
    

        <!-- this bean is a jscript bean and doesnt belong here but has to be here because the bean above it relies on it -->    
        <bean id="cstudioDmDependencyServiceScript" parent="baseJavaScriptExtension"
              class="org.craftercms.cstudio.alfresco.dm.script.DmDependencyServiceScript">
            <property name="extensionName"><value>dmDependencyService</value></property>
            <property name="servicesManager" ref="cstudioServicesManager" />
        </bean>

    <bean id="cstudioDmDeploymentService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmDeploymentServiceImpl"
            parent="cstudioRegistrableService">
        <property name="dmFilterWrapper" ref="cstudioDmFilterWrapper"/>
        <property name="deploymentService" ref="cstudioDeploymentServiceSimple" />
    </bean>

    <bean id="cstudioDmWorkflowControlService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmWorkflowControlServiceImpl"
            parent="cstudioRegistrableService" />

    <bean id="cstudioDmClipboardService" class="org.craftercms.cstudio.alfresco.dm.service.impl.DmClipboardServiceImpl"
            parent="cstudioRegistrableService">
        <property name="writeProcessor" ref="cstudioFormDmContentProcessor" />
    </bean>

    <bean id="cstudioRenditionService" class="org.craftercms.cstudio.alfresco.service.impl.RenditionServiceImpl"
            parent="cstudioRegistrableService">
        <property name="companyHomePath"><value>${companyHomePath}</value></property>
        <property name="scriptObjects">
          <map value-type="java.lang.Class">
          </map>
        </property>
    </bean>

    <bean id="cstudioTaxonomyService" class="org.craftercms.cstudio.alfresco.service.impl.TaxonomyServiceImpl"
            parent="cstudioRegistrableService"/>
    
    <bean id="cstudioFormService" class="org.craftercms.cstudio.alfresco.service.impl.FormServiceImpl"
            parent="cstudioRegistrableService">
        <property name="configPath"><value>${formService.configPath}</value></property>
        <property name="configFileName"><value>${formService.configFileName}</value></property>    
        <property name="xformPath"><value>${formService.xformPath}</value></property>
        <property name="includeTagPattern"><value>${formService.includeTagPattern}</value></property>
    </bean>

     <bean id="cstudioImportService" class="org.craftercms.cstudio.alfresco.util.impl.ImportServiceImpl"
             parent="cstudioRegistrableService">
        <property name="timezone"><value>${ServicesBootstrapBean.timezone}</value></property>
        <property name="configFileName"><value>${ServicesBootstrapBean.repositoryConfigFile}</value></property>
   </bean>

    <bean id="cstudioNodeService" class="org.craftercms.cstudio.alfresco.service.impl.CStudioNodeServiceImpl" parent="cstudioRegistrableService">
        <property name="companyHomeNodeLocator" ref="companyHomeNodeLocator" />
        <property name="pageNavigationOrderSequenceDaoService" ref="cstudioPageNavogationOrderSequenceDaoService" />
    </bean>

    <bean id="cstudioGeneralLockService" class="org.craftercms.cstudio.alfresco.service.impl.GeneralLockServiceImpl"
          parent="cstudioRegistrableService" />

    <bean id="cstudioObjectStateService" class="org.craftercms.cstudio.alfresco.service.impl.ObjectStateServiceImpl"
          parent="cstudioRegistrableService">
        <property name="objectStateDAOService" ref="cstudioObjectStateDaoService" />
    </bean>


    

    <!-- ////////////////////////////////////// -->
    <!--         configuration                  -->
    <!-- ////////////////////////////////////// -->
    
    
    <bean id="cstudioEnvironmentConfig" class="org.craftercms.cstudio.alfresco.service.impl.SiteEnvironmentConfigImpl"
            parent="cstudioRegistrableService">
        <property name="configPath"><value>${environmentConfig.configPath}</value></property>
        <property name="configFileName"><value>${environmentConfig.configFileName}</value></property>
        <property name="environment"><value>${environmentConfig.environment}</value></property>
    </bean>

    <bean id="cstudioDeploymentConfig" class="org.craftercms.cstudio.alfresco.service.impl.DeploymentEndpointConfigImpl"
          parent="cstudioRegistrableService">
        <property name="configPath"><value>${deploymentConfig.configPath}</value></property>
        <property name="configFileName"><value>${deploymentConfig.configFileName}</value></property>
    </bean>
    
    <bean id="cstudioContentTypesConfig" class="org.craftercms.cstudio.alfresco.service.impl.ContentTypesConfigImpl"
            parent="cstudioRegistrableService">
        <property name="configPath"><value>${contentTypesConfig.configPath}</value></property>
        <property name="configFileName"><value>${contentTypesConfig.configFileName}</value></property>
    </bean>
    
    <bean id="cstudioServicesConfig" class="org.craftercms.cstudio.alfresco.service.impl.ServicesConfigImpl"
            parent="cstudioRegistrableService">
        <property name="contentTypesConfig" ref="cstudioContentTypesConfig" />
        <property name="configPath"><value>${serviceConfig.configPath}</value></property>
        <property name="configFileName"><value>${serviceConfig.configFileName}</value></property>
    </bean>
    
    <!-- ////////////////////////////////////// -->
    <!--         Preview deployment beans       -->
    <!-- ////////////////////////////////////// -->
    <bean id="previewDeployer" class="org.craftercms.cstudio.alfresco.preview.PreviewDeployer">
        <property name="deployRoot"><value>${crafter.deployer.deployRoot}</value></property>
        <property name="metaDataRoot"><value>${crafter.deployer.metaDataRoot}</value></property>
        <property name="deployServer"><value>${crafter.deployer.server}</value></property>
        <property name="deployPort"><value>${crafter.deployer.port}</value></property>
        <property name="deployTarget"><value>${crafter.deployer.target}</value></property>
        <property name="deployPassword"><value>${crafter.deployer.password}</value></property>
        <property name="remoteDeployEnabled"><value>${crafter.deployer.remote.enabled}</value></property>
    </bean>

    <bean id="previewableAspect" class="org.craftercms.cstudio.alfresco.util.impl.PreviewableAspect" init-method="init">
        <property name="policyComponent" ref="policyComponent" />
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="deployer" ref="previewDeployer" />
    </bean>

    <bean id="previewableDraftAspect" class="org.craftercms.cstudio.alfresco.util.impl.PreviewableDraftAspect" init-method="init">
        <property name="policyComponent" ref="policyComponent" />
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="deployer" ref="previewDeployer" />
    </bean>

    <!-- -->
    <!-- -->

    <bean id="configurationSpaceExportAspect"
          class="org.craftercms.cstudio.alfresco.util.impl.ConfigurationSpaceExportAspect" init-method="init">
        <property name="persistenceManagerService" ref="cstudioPersistenceManagerService" />
        <property name="policyComponent" ref="policyComponent" />
        <property name="exportPath" value="${configSpaceExport.exportPath}"/>
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--       Workflow                   -->
    <!-- ////////////////////////////////////// -->

    <bean id="cstudioWorkflowListener" class="org.craftercms.cstudio.alfresco.dm.listener.impl.DmWorkflowListenerImpl">
        <property name="servicesManager" ref="cstudioServicesManager"/>
        <property name="cache" ref="cstudioCacheManager"/>
    </bean>

    <bean id="cstudioWorkflowProcessor" class="org.craftercms.cstudio.alfresco.dm.workflow.WorkflowProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioSubmitToWorkflowExecutor" class="org.craftercms.cstudio.alfresco.dm.executor.SubmitToWorkflowExecutor">
        <constructor-arg index="0"><ref bean="cstudioPersistenceManagerService"/></constructor-arg>
        <property name="submitDirectWorkflowName"><value>${cstudioWcmWorkflowService.submitDirectWorkflowName}</value></property>
        <property name="reviewWorkflowName"><value>${cstudioWcmWorkflowService.reviewWorkflowName}</value></property>
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--       Content ID Generator                   -->
    <!-- ////////////////////////////////////// -->

    <bean id="cstudioContentIdGenerator" class="org.craftercms.cstudio.alfresco.dm.service.impl.ContentItemIdGeneratorImpl"
            parent="cstudioRegistrableService"/>
    

    <!-- ////////////////////////////////////// -->
    <!--       Object type filters                   -->
    <!-- ////////////////////////////////////// -->
    <!-- this should be refactored and moved in to repo based config -->
    <!-- DM filters -->
    <bean id="cstudioDmFilterWrapper" class="org.craftercms.cstudio.alfresco.dm.filter.DmFilterWrapperImpl">
        <property name="filterMap">
            <map>
                <entry key="pages">
                    <ref bean="cstudioPagesFilter"/>
                </entry>
                <entry key="components">
                    <ref bean="cstudioComponentsFilter"/>
                </entry>
                <entry key="documents">
                    <ref bean="cstudioDocumentsFilter"/>
                </entry>
                <entry key="all">
                    <ref bean="cstudioAllFilter"/>
                </entry>
            </map>
        </property>
        <property name="defaultFilter" ref="cstudioAllFilter"/>
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioPagesFilter" class="org.craftercms.cstudio.alfresco.dm.filter.PageFilter">
        <property name="includePattern"><value>${cstudioPagesFilter.includePattern}</value></property>
    </bean>

    <bean id="cstudioComponentsFilter" class="org.craftercms.cstudio.alfresco.dm.filter.ComponentFilter">
        <property name="includePattern"><value>${cstudioComponentsFilter.includePattern}</value></property>
    </bean>

    <bean id="cstudioDocumentsFilter" class="org.craftercms.cstudio.alfresco.dm.filter.DocumentFilter">
        <property name="includePattern"><value>${cstudioDocumentsFilter.includePattern}</value></property>
    </bean>

    <bean id="cstudioAllFilter" class="org.craftercms.cstudio.alfresco.dm.filter.AllFilter">
    </bean>
    
    
    
    <!-- ////////////////////////////////////// -->
    <!--       Query Builders                   -->
    <!-- ////////////////////////////////////// -->

    <bean id="cstudioDmLuceneSearchQueryBuilder" class="org.craftercms.cstudio.alfresco.dm.util.impl.DmLuceneSearchQueryBuilder">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioDmSolrSearchQueryBuilder" class="org.craftercms.cstudio.alfresco.dm.util.impl.DmSolrSearchQueryBuilder">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>    

    <!-- see wcm-service-contex.xml for WcmSearchResultExtractor (TODO: might need to separate SearchService completely) -->    
    <!-- should this beans be kept?? -->
    <bean id="cstudioLuceneSearchQueryBuilder" class="org.craftercms.cstudio.alfresco.util.impl.LuceneSearchQueryBuilder">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>
    <!-- should this beans be kept?? -->
    <bean id="cstudioXPathSearchQueryBuilder" class="org.craftercms.cstudio.alfresco.util.impl.XPathSearchQueryBuilder">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioDmSearchResultExtractor" class="org.craftercms.cstudio.alfresco.util.impl.DmSearchResultExtractor">
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="contentMetadataExtractors">
            <map>
            </map>
        </property>
    </bean>

    <bean id="cstudioDmContentSearchResultExtractor" class="org.craftercms.cstudio.alfresco.dm.util.impl.DmSearchResultExtractor">
        <property name="defaultNumPerPage"><value>10</value></property>
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    
    <!-- ////////////////////////////////////// -->
    <!--           Action Executors             -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioProcessContentExecutor" class="org.craftercms.cstudio.alfresco.dm.executor.ProcessContentExecutor">
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="processorChains">
            <map>
                <entry key="assetContent"><ref bean="cstudioAssetContentProcessorPipeline"/></entry>
                <entry key="assetContentCleanDraft"><ref bean="cstudioAssetCleanContentProcessorPipeline"/></entry>
                <entry key="plainContent"><ref bean="cstudioPlainContentProcessorPipeline"/></entry>
                <entry key="formContent"><ref bean="cstudioFormContentProcessorPipeline"/></entry>
                <entry key="previewformContent"><ref bean="cstudioPreviewFormContentProcessorPipeline"/></entry>
                <entry key="importContent"><ref bean="cstudioImportContentProcessorPipeline"/></entry>
            </map>
        </property>
    </bean>

    <bean id="cstudioPreviewProcessContentExecutor" class="org.craftercms.cstudio.alfresco.dm.executor.ProcessContentExecutor">
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="processorChains">
            <map>
                <entry key="previewAssetContent"><ref bean="cstudioPreviewAssetContentProcessorPipeline"/></entry>
                <entry key="previewPlainContent"><ref bean="cstudioPreviewPlainContentProcessorPipeline"/></entry>
                <entry key="previewformContent"><ref bean="cstudioPreviewFormContentProcessorPipeline"/></entry>
            </map>
        </property>
    </bean>

    <!-- Content Item Extractor -->
    <bean id="cstudioDmContentItemExtractor"
          class="org.craftercms.cstudio.alfresco.util.impl.DmContentItemExtractor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--       Content processor pipelines      -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioAssetContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioFileFolderPathProcessor"></ref>
                <ref bean="cstudioCheckImageSizeProcessor"></ref>
                <ref bean="cstudioAssetDmContentProcessor"></ref>
                <ref bean="cstudioExtractAssetDependencyProcessor"></ref>
                <ref bean="cstudioPostActivityProcessor"></ref>
                <ref bean="cstudioInvalidateCacheProcessor"></ref>
            </list>
        </property>
    </bean>
    
    <bean id="cstudioAssetCleanContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioFileFolderPathProcessor"></ref>
                <ref bean="cstudioCheckImageSizeProcessor"></ref>
                <ref bean="cstudioAssetDmContentProcessor"></ref>
                <ref bean="cstudioCleanPreviewContentProcessor"></ref>
                <ref bean="cstudioPostActivityProcessor"></ref>
                <ref bean="cstudioInvalidateCacheProcessor"></ref>
            </list>
        </property>
    </bean>

    <bean id="cstudioPlainContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioFileFolderPathProcessor"></ref>
                <ref bean="cstudioFormDmContentProcessor"></ref>
            </list>
        </property>
    </bean>

    <bean id="cstudioFormContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioExtractParamsProcessor"></ref>
                <ref bean="cstudioFormNavOrderProcessor"></ref>
                <ref bean="cstudioFileFolderPathProcessor"></ref>
                <ref bean="cstudioCleanWorkContentProcessor"></ref>
                <ref bean="cstudioFormDmContentProcessor"></ref>
                <!--<ref bean="cstudioWcmSnapshotProcessor"></ref>-->
                <ref bean="cstudioCleanPreviewContentProcessor"></ref>
                <ref bean="cstudioExtractMetadataProcessor"></ref>
                <ref bean="cstudioExtractDependencyProcessor"></ref>
                <ref bean="cstudioDmWorkflowProcessor"></ref>
                <ref bean="cstudioPostActivityProcessor"></ref>
                <ref bean="cstudioContentLifeCycleProcessor"></ref>
                <ref bean="cstudioInvalidateCacheProcessor"></ref>
            </list>
        </property>
    </bean>

    <bean id="cstudioPreviewAssetContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioFileFolderPathProcessor"></ref>
                <!--<ref bean="cstudioCheckImageSizeProcessor"></ref>-->
                <ref bean="cstudioAssetDmContentProcessor"></ref>
            </list>
        </property>
    </bean>

    <bean id="cstudioPreviewPlainContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioFileFolderPathProcessor"></ref>
                <ref bean="cstudioFormDmContentProcessor"></ref>
            </list>
        </property>
    </bean>

    <bean id="cstudioPreviewFormContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioExtractParamsProcessor"></ref>
                <ref bean="cstudioFormDmContentProcessor"></ref>
            </list>
        </property>
    </bean>

    <bean id="cstudioImportContentProcessorPipeline" class="org.craftercms.cstudio.alfresco.content.pipeline.impl.ContentProcessorPipelineImpl">
        <property name="chain">
            <list>
                <ref bean="cstudioExtractParamsProcessor"></ref>
                <ref bean="cstudioFormNavOrderProcessor"></ref>
                <ref bean="cstudioFileFolderPathProcessor"></ref>
                <ref bean="cstudioImportContentProcessor"></ref>
                <ref bean="cstudioExtractMetadataProcessor"></ref>
                <ref bean="cstudioExtractDependencyProcessor"></ref>
                <ref bean="cstudioPostActivityProcessor"></ref>
                <ref bean="cstudioContentLifeCycleProcessor"></ref>
                <ref bean="cstudioInvalidateCacheProcessor"></ref>
            </list>
        </property>
    </bean>

    <!-- ///////////////////////////// -->
    <!--       Content processors      -->
    <!-- //////////////////////////// -->

    <bean id="cstudioFormNavOrderProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.FormNavOrderProcessor">
        <property name="pageNavOrderService" ref="cstudioPageNavOrderService" />
    </bean>
    
    <bean id="cstudioFileFolderPathProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.FileFolderPathProcessor"/>

    <bean id="cstudioCheckImageSizeProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.CheckImageSizeProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioAssetDmContentProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.AssetDmContentProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="assetsSystemPath" value="${AssetsContentProccessot.assetsSystemPath}" />
    </bean>

    <bean id="cstudioPostActivityProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.PostActivityProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioInvalidateCacheProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.InvalidateCacheProcessor">
        <property name="dmContentService" ref="cstudioDmContentService" />
        <property name="cache" ref="cstudioCacheManager" />
    </bean>

    <bean id="cstudioFormDmContentProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.FormDmContentProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioImportContentProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ImportDmContentProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioExtractParamsProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ExtractParamsProcessor">
        <property name="params">
            <map>
                <entry><key><value>fileName</value></key><value>file-name</value></entry>
                <entry><key><value>contentType</value></key><value>content-type</value></entry>
            </map>
        </property>
    </bean>

    <bean id="cstudioCleanWorkContentProcessor"
          class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.CleanWorkContentProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioCleanPreviewContentProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.CleanPreviewContentProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioExtractMetadataProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ExtractMetadataProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioExtractDependencyProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ExtractDependencyProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioExtractAssetDependencyProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ExtractAssetDependencyProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioDmWorkflowProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.DmWorkflowProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioContentLifeCycleProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ContentLifeCycleProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioImportAddDmMetadataProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ImportAddDmMetadataProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioImportExtractMetadataProcessor" class="org.craftercms.cstudio.alfresco.dm.content.pipeline.impl.ImportExtractMetadataProcessor">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>


    <!-- ////////////////////// -->
    <!-- Schedule delete  -->
    <!-- ////////////////////// -->
    <bean id="cstudioScheduleDeleteHandler" class="org.craftercms.cstudio.alfresco.dm.util.impl.ScheduleDeleteHandler">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <!-- ////////////////////// -->
    <!-- Property Loaders  -->
    <!-- ////////////////////// -->
    <bean id="cstudioPropertyLoaders" class="java.util.ArrayList">
        <constructor-arg>
            <list>
                <ref bean="cstudioXPathPropertiesLoader"/>
                <ref bean="cstudioImagePropertiesLoader"/>
            </list>
        </constructor-arg>
    </bean>

    <bean id="cstudioImagePropertiesLoader" class="org.craftercms.cstudio.alfresco.dm.util.impl.ImagePropertiesLoader">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>

    <bean id="cstudioXPathPropertiesLoader" class="org.craftercms.cstudio.alfresco.dm.util.impl.XPathPropertiesLoader">
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="pathProperties">
            <map>
                <!--  example property -->
                <!-- entry key="internalName"><value>internal-name</value></entry-->
            </map>
        </property>
    </bean>

    <!-- ////////////////////// -->
    <!-- Email  -->
    <!-- ////////////////////// -->
    <bean id="cstudioEmailMessageQueue" class="org.craftercms.cstudio.alfresco.to.EmailMessageQueueTo">    
    </bean>
    
    <bean id="cstudioEmailMessageSender" class="org.craftercms.cstudio.alfresco.job.EmailMessageSender" init-method="initThread">
        <property name="emailMessages" ref="cstudioEmailMessageQueue" />
        <property name="emailService" ref="mailService" />
        <property name="defaultFromAddress"><value>${mail.from.default}</value></property>
    </bean>

    <!-- Add reload site service action -->
    <bean id="reload-site-service-config" class="org.craftercms.cstudio.alfresco.action.ReloadSiteServiceConfigActionExecutor" parent="action-executer">
        <property name="siteService">
            <ref bean="cstudioSiteService" />
        </property>
    </bean>

    <bean id="extract-cstudio-metadata" class="org.craftercms.cstudio.alfresco.action.ExtractCStudioMetadataActionExecutor" parent="action-executer">
        <property name="servicesManager" ref="cstudioServicesManager" />
    </bean>


    <!-- ////////////////////////////////////// -->
    <!-- Import     -->
    <!-- ////////////////////////////////////// -->

    <bean id="cstudioDmImportService" class="org.craftercms.cstudio.alfresco.dm.util.impl.DmImportServiceImpl"
            parent="cstudioRegistrableService">
        <property name="authenticationService" ref="AuthenticationService" />
        <property name="nodeService" ref="nodeService" />
        <property name="workflowProcessor" ref="cstudioWorkflowProcessor" />
        <property name="workflowName"><value>${dmImportService.workflowName}</value></property>
        <property name="assignee"><value>${dmImportService.assignee}</value></property>
        <property name="xmlChainName"><value>${dmImportService.xmlChainName}</value></property>
        <property name="assetChainName"><value>${dmImportService.assetChainName}</value></property>
    </bean>
    
    <bean id="dm-import-action"
        class="org.craftercms.cstudio.alfresco.action.DmImportActionExecutor"
        parent="action-executer">
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="importService" ref="cstudioDmImportService" />
    </bean>

    <bean id="dm-publish-action"
        class="org.craftercms.cstudio.alfresco.action.DmPublishActionExecutor"
        parent="action-executer">
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="importService" ref="cstudioDmImportService" />
    </bean>

    <!-- //////////////////////// -->
    <!-- Events -->
    <!-- //////////////////////// -->
    <bean id="cstudioEventService" name="cstudioEventService" class="org.craftercms.cstudio.alfresco.event.EventServiceImpl"
            parent="cstudioRegistrableService">
    </bean>

    <bean id="cstudioDeploymentEventsLoggerListener" name="cstudioDeploymentEventsLoggerListener" class="org.craftercms.cstudio.alfresco.deployment.DeploymentEventsLoggerListener"
          init-method="subscribeToDeploymentEvents">
        <property name="beanName" value="cstudioDeploymentEventsLoggerListener" />
        <property name="eventService" ref="cstudioEventService" />
    </bean>


<!--  ======================= -->


    <!-- ////////////////////////////////////// -->
    <!--         repository layer               -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioContentRepository" class="org.craftercms.cstudio.impl.repository.alfresco.AlfrescoContentRepository">
        <property name="dmContentService" ref="cstudioDmContentService" />
        <property name="servicesManager" ref="cstudioServicesManager" />
        <property name="transactionService" ref="TransactionService" />
        <property name="dmFilterWrapper" ref="cstudioDmFilterWrapper" />
    </bean>


    <!-- ////////////////////////////////////// -->
    <!--         services                       -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioTransactionServiceSimple" class="org.craftercms.cstudio.impl.service.transaction.TransactionServiceImpl">
        <property name="contentRepository" ref="cstudioContentRepository" />
    </bean>

    <bean id="cstudioAuthenticationServiceSimple" class="org.craftercms.cstudio.impl.service.authentication.AuthenticationServiceImpl">
        <property name="contentRepository" ref="cstudioContentRepository" />
    </bean>

    <bean id="cstudioSiteServiceSimple" class="org.craftercms.cstudio.impl.service.site.SiteServiceImpl">
        <property name="siteServiceDAL" ref="cstudioRepositorySiteServiceDAL" />
    </bean>

    <bean id="cstudioWorkflowService" class="org.craftercms.cstudio.impl.service.workflow.WorkflowServiceImpl">
        <property name="workflowJobDAL" ref="cstudioWorkflowJobDAL" />
        <property name="notificationService" ref="cstudioNotificationService" />
        <!-- remove this asap -->
        <property name="dmWorkflowService" ref="cstudioDmWorkflowService" />
    </bean>

    <bean id="cstudioTranslationService" class="org.craftercms.cstudio.impl.service.translation.TranslationServiceImpl">
        <property name="translationContentDAL" ref="cstudioTranslationContentDAL" />
        <property name="translationProvider" ref="demoTranslationProvider" />
    </bean>

    <bean id="cstudioDeploymentServiceSimple" class="org.craftercms.cstudio.impl.service.deployment.DeploymentServiceImpl" >
        <property name="contentRepository" ref="cstudioContentRepository" />
        <property name="deploymentDAL" ref="cstudioDeploymentServiceDAL" />
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--         site service                   -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioRepositorySiteServiceDAL" class="org.craftercms.cstudio.impl.service.site.dal.RepositorySiteServiceDAL">
        <property name="contentRepository" ref="cstudioContentRepository" />
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--         deployment service             -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioDeploymentServiceDAL" class="org.craftercms.cstudio.impl.service.deployment.dal.DeploymentDALImpl"
            init-method="initTable">
        <property name="contentRepository" ref="cstudioContentRepository" />
        <property name="initializeWorkerTablesScriptPath"><value>alfresco/deployment/${hibernate.dialect}/initialize_deployment_workers.sql</value></property>
        <property name="initializeHistoryTableScriptPath"><value>alfresco/deployment/${hibernate.dialect}/initialize_deployment_sync_history.sql</value></property>
        <property name="addSubmissionCommentCTEScriptPath"><value>alfresco/deployment/${hibernate.dialect}/add_submission_comment_cte.sql</value></property>
        <property name="sqlMapClient" ref="cstudioCopyToEnvironmentSqlMap" />
        <property name="sqlBatchMaxSize" value="${deploymentDAL.sqlBatchMaxSize}" />
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--         publishing manager             -->
    <!-- ////////////////////////////////////// -->
    <bean id="cstudioPublishingManager" class="org.craftercms.cstudio.impl.service.deployment.PublishingManagerImpl">
        <property name="contentRepository" ref="cstudioContentRepository" />
        <property name="deploymentDAL" ref="cstudioDeploymentServiceDAL" />
        <property name="indexFile" value="${publishingManager.indexFile}" />
        <property name="importModeEnabled" value="${publishingManager.importModeEnabled}" />
    </bean>


    <!-- ////////////////////////////////////// -->
    <!--         translation                    -->
    <!-- ////////////////////////////////////// -->

    <!-- translation vendor interface -->
    <bean id="smartlingTranslationProvider" class="org.craftercms.cstudio.impl.service.translation.provider.smartling.SmartlingTranslationProvider">
    </bean>

    <bean id="demoTranslationProvider" class="org.craftercms.cstudio.impl.service.translation.provider.demo.DemoTranslationProvider">
        <property name="translateElements">
            <list>
                <value>title</value>
                <value>body</value>
                <value>body_html</value>
            </list>
        </property>
    </bean>

    <!-- ////////////////////////////////////// -->
    <!--         workflow                       -->
    <!-- ////////////////////////////////////// -->
    <!-- DALs -->
    <bean id="cstudioWorkflowJobDAL" class="org.craftercms.cstudio.impl.service.workflow.dal.InMemoryWorkflowJobDAL"/>
    <!--bean id="cstudioWorkflowJobDAL" class="org.craftercms.cstudio.impl.service.workflow.dal.DbWorkflowJobDAL"
          init-method="initTable">
        <property name="sqlMap" ref="cstudioWorkflowSqlMap"/>
        <property name="initializeScriptPath" value="alfresco/workflow/${hibernate.dialect}/initialize.sql"/>
    </bean-->

    <bean id="cstudioTranslationContentDAL" class="org.craftercms.cstudio.impl.service.translation.dal.repository.RepositoryTranslationContentDAL">
        <property name="contentRepository" ref="cstudioContentRepository" />
    </bean>

    <bean id="cstudioWorkflowManager" class="org.craftercms.cstudio.impl.service.workflow.WorkflowManager">
        <property name="workflowService" ref="cstudioWorkflowService" />
        <property name="jobStateHandlers" >
            <map>
                <entry key="submit-for-translate">
                    <map>
                        <entry key="created">
                            <bean class="org.craftercms.cstudio.impl.service.workflow.handler.JobCreatedHandler">
                            </bean>
                        </entry>
                        <entry key="started">
                            <!-- determine what items for be translated for each child site and submit workflows then end -->
                            <bean class="org.craftercms.cstudio.impl.service.translation.workflow.handler.KickoffTranslationWorkflowForWaterfallItemsHandler">
                                <property name="siteService" ref="cstudioSiteServiceSimple" />
                                <property name="translationService" ref="cstudioTranslationService" />
                                <property name="dependencyService" ref="cstudioDmDependencyService" />
                            </bean>
                        </entry>
                        <entry key="ended">
                            <bean class="org.craftercms.cstudio.impl.service.workflow.handler.JobEndedHandler"/>
                        </entry>
                    </map>
                </entry>
                <entry key="translate">
                    <map>
                        <entry key="created">
                            <bean class="org.craftercms.cstudio.impl.service.workflow.handler.JobCreatedHandler">
                            </bean>
                        </entry>
                        <entry key="started">
                            <!-- send item out for translation and start waiting for it to complete -->
                            <bean class="org.craftercms.cstudio.impl.service.translation.workflow.handler.SendItemOutForTranslationHandler">
                                <property name="translationService" ref="cstudioTranslationService" />
                            </bean>
                        </entry>
                        <entry key="WAITING-FOR-TRANSLATION">
                            <!-- check translation status on item until it's complete -->
                            <bean class="org.craftercms.cstudio.impl.service.translation.workflow.handler.UpdateItemTranslationStatusHandler">
                                <property name="translationService" ref="cstudioTranslationService" />
                            </bean>
                        </entry>
                        <entry key="TRANSLATION-COMPLETE">
                            <!-- retrieve item from translation provider, add to project and submit for review -->
                            <bean class="org.craftercms.cstudio.impl.service.translation.workflow.handler.UpdateProjectWithTranslationHandler">
                                <property name="translationService" ref="cstudioTranslationService" />
                            </bean>
                        </entry>
                        <entry key="SITE-UPDATED-WITH-TRANSLATED-CONTENT">
                            <!-- retrieve item from translation provider, add to project and submit for review -->
                            <bean class="org.craftercms.cstudio.impl.service.workflow.handler.SubmitContentforApprovalHandler"/>
                        </entry>
                        <entry key="ended">
                            <bean class="org.craftercms.cstudio.impl.service.workflow.handler.JobEndedHandler"/>
                        </entry>
                    </map>
                </entry>
            </map>
        </property>
    </bean>

    <!-- Jobs -->
    <bean id="cstudioProcessInFlightJobs" class="org.craftercms.cstudio.impl.service.workflow.job.ProcessInFlightJobs">
        <property name="workflowService" ref="cstudioWorkflowService" />
        <property name="workflowManager" ref="cstudioWorkflowManager"/>
        <property name="transactionService" ref="cstudioTransactionServiceSimple" />
        <property name="authenticationService" ref="cstudioAuthenticationServiceSimple" />
    </bean>

    <bean id="cstudioDeployContentToEnvironmentJobs" class="org.craftercms.cstudio.impl.service.deployment.job.DeployContentToEnvironmentStore">
        <property name="authenticationService" ref="cstudioAuthenticationServiceSimple" />
        <property name="transactionService" ref="cstudioTransactionServiceSimple" />
        <property name="publishingManager" ref="cstudioPublishingManager" />
        <property name="contentRepository" ref="cstudioContentRepository" />
        <property name="processingChunkSize" value="${deployContentToEnvironmentJob.processingChunkSize}" />
        <property name="masterPublishingNode" value="${deploymentWorkers.masterPublishingNode}" />
        <property name="mandatoryDependenciesCheckEnabled" value="${deployContentToEnvironmentJob.mandatoryDependenciesCheckEnabled}" />
    </bean>

    <bean id="cstudioSyncTargetsJobs" class="org.craftercms.cstudio.impl.service.deployment.job.PublishContentToDeploymentTarget">
        <property name="authenticationService" ref="cstudioAuthenticationServiceSimple" />
        <property name="publishingManager" ref="cstudioPublishingManager" />
        <property name="transactionService" ref="cstudioTransactionServiceSimple" />
        <property name="maxTolerableRetries" value="${syncTargetsJob.maxTolerableRetries}" />
        <property name="masterPublishingNode" value="${deploymentWorkers.masterPublishingNode}" />
    </bean>

    <!-- scheduled actions -->
    <bean id="cstudioProcessInFlightJobsScheduled" class="org.alfresco.util.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
              <property name="targetObject" ref="cstudioProcessInFlightJobs"/>
              <property name="targetMethod" value="execute"/>
              <property name="concurrent" value="false"/>
            </bean>
        </property>
        <property name="scheduler">
            <ref bean="schedulerFactory" />
        </property>
        <!-- Repeat hourly on the half hour -->
        <property name="cronExpression">
            <value>0/10 * * * * ?</value>
        </property>
    </bean>

    <bean id="cstudioDeployContentToEnvironmentJobsScheduled" class="org.alfresco.util.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
                <property name="targetObject" ref="cstudioDeployContentToEnvironmentJobs"/>
                <property name="targetMethod" value="execute"/>
                <property name="concurrent" value="false"/>
            </bean>
        </property>
        <property name="scheduler">
            <ref bean="schedulerFactory" />
        </property>
        <!-- Repeat hourly on the half hour -->
        <property name="cronExpression">
            <value>2/10 * * * * ?</value>
        </property>
    </bean>

    <bean id="cstudioSyncTargetsJobsScheduled" class="org.alfresco.util.CronTriggerBean">
        <property name="jobDetail">
            <bean class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
                <property name="targetObject" ref="cstudioSyncTargetsJobs"/>
                <property name="targetMethod" value="execute"/>
                <property name="concurrent" value="false"/>
            </bean>
        </property>
        <property name="scheduler">
            <ref bean="schedulerFactory" />
        </property>
        <!-- Repeat hourly on the half hour -->
        <property name="cronExpression">
            <value>4/10 * * * * ?</value>
        </property>
    </bean>

</beans>
